# PDF 导出功能使用指南

## 功能概述

AICouncil 支持将讨论报告导出为高质量 PDF 文档，保留：
- ✅ **超链接**：点击可跳转
- ✅ **完整样式**：保留原始 HTML 样式
- ✅ **图表渲染**：ECharts 图表完整显示
- ✅ **避免截断**：智能分页，避免内容被截断

## 两种导出方式

### 方式 1：Playwright 高质量导出（推荐）

**优点：**
- 高质量 PDF 输出
- 保留超链接和交互元素
- 完整的图表渲染
- 智能分页，避免截断

**首次使用步骤：**

1. **生成讨论报告**
   - 完成一次议事讨论
   - 等待报告生成完成

2. **尝试导出 PDF**
   - 点击报告页面的【导出PDF】按钮
   - 如果提示"Playwright 未安装"，进入下一步

3. **安装 Playwright**（首次使用）
   - 点击【安装 Playwright】按钮
   - 等待下载 Chromium 浏览器（约 150MB）
   - 安装时间：2-5 分钟（取决于网速）
   - 安装位置：`%APPDATA%\AICouncil\playwright\`

4. **重新导出**
   - 安装完成后，重新点击【导出PDF】
   - PDF 文件自动下载到浏览器默认下载目录

**后续使用：**
- 安装一次后，后续可直接使用
- 无需重复安装

### 方式 2：客户端导出（备用）

如果 Playwright 安装失败或不想安装，可使用备用方案：

1. 点击【导出HTML】，下载 HTML 文件
2. 使用浏览器打开 HTML 文件
3. 按 `Ctrl + P`（打印）
4. 选择"另存为 PDF"

**注意：** 此方式可能导致部分内容截断，且不保留超链接。

## 常见问题

### Q1: Playwright 安装失败怎么办？

**可能原因：**
- 网络问题（需要下载 150MB 浏览器）
- 磁盘空间不足

**解决方案：**
1. 检查网络连接
2. 确保有至少 500MB 可用磁盘空间
3. 使用备用导出方式（方式 2）
4. 手动安装：
   ```bash
   # 打开控制台（EXE 启动时已有）
   pip install playwright
   playwright install chromium
   ```

### Q2: 安装位置在哪？可以删除吗？

**安装位置：**
```
C:\Users\{你的用户名}\AppData\Roaming\AICouncil\playwright\
```

**删除：**
- 可以删除，下次使用时重新安装
- 建议保留，避免每次重新下载

### Q3: 为什么打包版本不直接包含浏览器？

**原因：**
- Chromium 浏览器约 150MB
- 打包后 EXE 会增加到 180MB+
- 按需安装更灵活，减少下载体积

### Q4: 图表不显示怎么办？

**检查：**
1. 确保报告中有 ECharts 图表
2. 等待图表加载完成后再导出
3. 如果图表仍不显示，使用【导出HTML】查看原始报告

## 技术细节

### Playwright 是什么？

Playwright 是 Microsoft 开发的自动化测试工具，内置 Chromium 浏览器引擎，可以：
- 渲染完整的 HTML 页面
- 执行 JavaScript 代码
- 生成高质量 PDF

### 为什么需要 Chromium？

PDF 导出需要：
1. 渲染 HTML + CSS 样式
2. 执行 ECharts JavaScript 生成图表
3. 转换为 PDF 格式

Chromium 提供了完整的渲染引擎，确保导出质量。

### 安全性

- Playwright 是微软官方项目，开源可信
- Chromium 是 Google 官方浏览器引擎
- 安装在本地用户目录，不影响系统
- 仅用于 PDF 生成，不联网

## 性能对比

| 方式 | 文件大小 | 质量 | 超链接 | 图表 | 安装 |
|------|---------|------|--------|------|------|
| **Playwright** | 适中 | ⭐⭐⭐⭐⭐ | ✅ | ✅ | 首次 2-5 分钟 |
| **客户端导出** | 较大 | ⭐⭐⭐ | ❌ | ⚠️ | 无需安装 |

## 更新日志

### v1.0.0（2025-12-31）
- ✅ 集成 Playwright 自动安装
- ✅ 支持一键安装 Chromium
- ✅ 优化错误提示
- ✅ 添加安装进度显示
